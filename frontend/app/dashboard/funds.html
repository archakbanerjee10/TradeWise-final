<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TradeWise | Funds Watchlist</title>
  <style>
  *{
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Inter, system-ui, Arial, sans-serif;
}

body {
  background: radial-gradient(circle at top, #0f172a, #020617);
  color: #e5e7eb;
}

/* Layout */
.container {
  width: 1100px;
  margin: 40px auto;
}

/* Heading */
h1 {
  font-size: 26px;
  margin-bottom: 6px;
}

h1 span {
  color: #2dd4bf;
}

.sub {
  color: #9ca3af;
  margin-bottom: 25px;
  font-size: 14px;
}

/* Watchlist Table */
.watchlist {
  background: linear-gradient(180deg, #0b1220, #020617);
  border-radius: 14px;
  overflow: hidden;
  border: 1px solid #1f2937;
  box-shadow: 0 30px 80px rgba(0, 0, 0, 0.6);
}

/* Rows */
.row {
  display: grid;
  grid-template-columns: 4fr 1.2fr 1.2fr;
  padding: 16px 22px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  align-items: center;
}

.header {
  font-size: 13px;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: #9ca3af;
  background: rgba(255, 255, 255, 0.02);
}
.navbar {
  display: flex;
  justify-content: space-between;
  padding: 18px 40px;
  border-bottom: 1px solid #1e293b;
}

.nav-left {
  display: flex;
  align-items: center;
  gap: 16px;
}

.logo {
  background: #2dd4bf;
  color: black;
  font-weight: bold;
  padding: 8px 12px;
  border-radius: 10px;
}

.brand {
  font-weight: 600;
}

nav a {
  margin: 0 10px;
  color: #94a3b8;
}

nav a.active {
  color: white;
}

.nav-right {
  display: flex;
  align-items: center;
  gap: 14px;
}

.nav-right input {
  background: #020617;
  border: 1px solid #1e293b;
  padding: 8px 12px;
  border-radius: 10px;
  color: white;
}

/* Fund Rows */
.fund-row {
  cursor: pointer;
  transition: background 0.25s ease, transform 0.15s ease;
}

.fund-row:hover {
  background: rgba(45, 212, 191, 0.06);
  transform: scale(1.002);
}

/* NAV */
.row span:nth-child(2) {
  font-weight: 600;
}

/* Date */
.row span:nth-child(3) {
  color: #9ca3af;
  font-size: 13px;
}

/* Modal */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(2, 6, 23, 0.75);
  backdrop-filter: blur(6px);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10;
}

.hidden {
  display: none;
}

.modal-content {
  background: linear-gradient(180deg, #020617, #020617);
  width: 900px;
  border-radius: 16px;
  padding: 25px;
  border: 1px solid #1f2937;
  box-shadow: 0 40px 100px rgba(0, 0, 0, 0.8);
}

/* Modal Title */
.modal-content h2 {
  margin-bottom: 16px;
  font-size: 20px;
  color: #2dd4bf;
}

/* Chart */
canvas {
  margin-top: 10px;
}

/* Button */
button {
  margin-top: 18px;
  padding: 10px 18px;
  border-radius: 8px;
  border: none;
  background: linear-gradient(135deg, #2dd4bf, #22c55e);
  color: #020617;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.15s ease, box-shadow 0.15s ease;
}

button:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 25px rgba(45, 212, 191, 0.35);
}
/* NAV Glow */
.nav-up {
  color: #22c55e;
  background: linear-gradient(
    90deg,
    rgba(34, 197, 94, 0.25),
    rgba(34, 197, 94, 0.05)
  );
  border-radius: 6px;
  padding: 4px 8px;
  box-shadow: 0 0 12px rgba(34, 197, 94, 0.35);
  animation: pulseGreen 1.6s ease-in-out infinite alternate;
}

.nav-down {
  color: #ef4444;
  background: linear-gradient(
    90deg,
    rgba(239, 68, 68, 0.25),
    rgba(239, 68, 68, 0.05)
  );
  border-radius: 6px;
  padding: 4px 8px;
  box-shadow: 0 0 12px rgba(239, 68, 68, 0.35);
  animation: pulseRed 1.6s ease-in-out infinite alternate;
}


/* Animations */
@keyframes pulseGreen {
  from { box-shadow: 0 0 6px rgba(34,197,94,0.3); }
  to   { box-shadow: 0 0 14px rgba(34,197,94,0.6); }
}

@keyframes pulseRed {
  from { box-shadow: 0 0 6px rgba(239,68,68,0.3); }
  to   { box-shadow: 0 0 14px rgba(239,68,68,0.6); }
}
</style>
</head>
<body>
 <header class="navbar">
    <div class="nav-left">
      <div class="logo">T</div>
      <span class="brand">TradeWise</span>
      <nav>
  <a href="/dashboard" style="text-decoration: none;">Dashboard</a>

  <a href="/dashboard/portfolio" style="text-decoration: none;">
    Portfolio
  </a>

  <a href="/dashboard/markets" style="text-decoration: none;">
    Markets
  </a>

  <a class="active">
    Funds
  </a>

  <a href="/dashboard/orders" style="text-decoration: none;">
    Orders
  </a>

  <a href="/dashboard/news" style="text-decoration: none;">
    News
  </a>

  <a href="/dashboard/support" style="text-decoration: none;">
    Support
  </a>
</nav>

    </div>
</header>
  <div class="container">
    <h1>Funds Watchlist</h1>

    <div class="watchlist">
      <div class="row header">
        <span>Fund</span>
        <span>NAV</span>
        <span>Date</span>
      </div>

      <div id="funds-list"></div>
    </div>
  </div>

  <!-- NAV History Modal -->
  <div id="modal" class="modal hidden">
    <div class="modal-content">
      <h2 id="modal-title"></h2>
      <canvas id="chart"></canvas>
      <button onclick="closeModal()">Close</button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const funds = [
  { name: "HDFC Large and Mid Cap Fund – Growth", id: "118989" },
  { name: "SBI US Specific Equity Active FoF – Direct Plan – Growth", id: "148760" },
  { name: "Axis Innovation Fund – Regular Plan – IDCW", id: "148633" },
  { name: "ICICI Prudential Business Cycle Fund – Direct Plan – Growth", id: "148633" },
  { name: "Nippon India Multi Asset Allocation Fund – Direct Plan – Growth", id: "148457" },
  { name: "Parag Parikh Flexy Cap Fund – Regular Plan – Growth", id: "122640" },
  { name: "Templeton India Value Fund - Growth Plan", id: "100496" },
  { name: "Franklin India Flexi Cap Fund - IDCW", id: "100519" },
  { name: "Kotak Bond Fund - Regular Plan - Standard IDCW ", id: "100300" },
  { name: "DSP Gilt Fund - Regular Plan - IDCW", id: "100085" }
];

const list = document.getElementById("funds-list");
const modal = document.getElementById("modal");
const modalTitle = document.getElementById("modal-title");
const ctx = document.getElementById("chart").getContext("2d");

let chart;

/* Load watchlist */
async function loadFunds() {
  list.innerHTML = "";
  for (const fund of funds) {
    const res = await fetch(`https://api.mfapi.in/mf/${fund.id}/latest`);
    const json = await res.json();
    const latest = json.data[0];

    const row = document.createElement("div");
    row.className = "row fund-row";
    row.innerHTML = `
      <span>${fund.name}</span>
      <span>₹ ${parseFloat(latest.nav).toFixed(2)}</span>
      <span>${latest.date}</span>
    `;

    row.onclick = () => openHistory(fund);
    list.appendChild(row);
  }
}

/* Open NAV history */
async function openHistory(fund) {
  modal.classList.remove("hidden");
  modalTitle.innerText = fund.name;

  const res = await fetch(`https://api.mfapi.in/mf/${fund.id}`);
  const json = await res.json();

  const labels = json.data.slice(-100).map(d => d.date).reverse();
  const values = json.data.slice(-100).map(d => d.nav).reverse();

  if (chart) chart.destroy();

  chart = new Chart(ctx, {
    type: "line",
    data: {
      labels,
      datasets: [{
        label: "NAV",
        data: values,
        borderColor: "#387ed1",
        tension: 0.2
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { display: false } }
    }
  });
}

function closeModal() {
  modal.classList.add("hidden");
}

loadFunds();

const user = localStorage.getItem("user");
if (!user) {
  window.location.href = "/";
}

  </script>
</body>
</html>